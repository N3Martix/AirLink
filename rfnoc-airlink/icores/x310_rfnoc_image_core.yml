# General parameters
# -----------------------------------------
schema: rfnoc_imagebuilder_args         # Identifier for the schema used to validate this file
copyright: >-                           # Copyright information used in file headers
  Ettus Research, A National Instruments Brand
license: >-                             # License information used in file headers
  SPDX-License-Identifier: LGPL-3.0-or-later
version: '1.0'                          # File version (must be string so we can distinguish 1.1 and 1.10)
chdr_width: 64                          # Bit width of the CHDR bus for this image
device: 'x310'
default_target: 'X310_HG'

# A list of all stream endpoints in design
# ----------------------------------------
stream_endpoints:
  ep0:                                  # Stream endpoint name
    ctrl: True                          # Endpoint passes control traffic
    data: True                          # Endpoint passes data traffic
    buff_size: 32768                    # Ingress buffer size for data
  ep1:
    ctrl: False
    data: True
    buff_size: 0
  ep2:
    ctrl: False
    data: True
    buff_size: 32768
  ep3:
    ctrl: False
    data: True
    buff_size: 0

# A list of all NoC blocks in design
# ----------------------------------
noc_blocks:
  radio0:                               # NoC block name
    block_desc: 'radio.yml'             # Block device descriptor file
    parameters:
      NUM_PORTS: 2
  radio1:
    block_desc: 'radio.yml'
    parameters:
      NUM_PORTS: 2
  # Here's our new block:
  shiftright0:
    block_desc: 'shiftright.yml'
  shiftright1:
    block_desc: 'shiftright.yml'

  fir0:
    block_desc: 'fir_filter.yml'
    parameters:
      NUM_PORTS: 1
  fir1:
    block_desc: 'fir_filter.yml'
    parameters:
      NUM_PORTS: 1

# A list of all static connections in design
# ------------------------------------------
# Format: A list of connection maps (list of key-value pairs) with the following keys
#   - srcblk  = Source block to connect
#   - srcport = Port on the source block to connect
#   - dstblk  = Destination block to connect
#   - dstport = Port on the destination block to connect
connections:
  # Downlink:
  # RF A RX -> FIR0 -> Shift0 -> RF B TX
  - { srcblk: radio0,      srcport: out_0, dstblk: fir0,        dstport: in_0 }
  - { srcblk: fir0,        srcport: out_0, dstblk: shiftright0, dstport: in   }
  - { srcblk: shiftright0, srcport: out,   dstblk: radio1,      dstport: in_0 }

  # Uplink:
  # RF A TX <- Shift1 <- FIR1 <- RF B RX
  - { srcblk: radio1,      srcport: out_0, dstblk: fir1,        dstport: in_0 }
  - { srcblk: fir1,        srcport: out_0, dstblk: shiftright1, dstport: in   }
  - { srcblk: shiftright1, srcport: out,   dstblk: radio0,      dstport: in_0 }

  # Unused Connections:
  # RF A RX2
  - { srcblk: radio0, srcport: out_1, dstblk: ep1, dstport: in0  }
  # RF B RX2
  - { srcblk: radio1, srcport: out_1, dstblk: ep3, dstport: in0  }
  
  #
  # BSP Connections
  - { srcblk: radio0,   srcport: ctrlport, dstblk: _device_, dstport: ctrlport_radio0 }
  - { srcblk: radio1,   srcport: ctrlport, dstblk: _device_, dstport: ctrlport_radio1 }
  - { srcblk: _device_, srcport: radio0,   dstblk: radio0,   dstport: radio           }
  - { srcblk: _device_, srcport: radio1,   dstblk: radio1,   dstport: radio           }
  - { srcblk: _device_, srcport: time,     dstblk: radio0,   dstport: time            }
  - { srcblk: _device_, srcport: time,     dstblk: radio1,   dstport: time            }

# A list of all clock domain connections in design
# ------------------------------------------------
# Format: A list of connection maps (list of key-value pairs) with the following keys
#   - srcblk  = Source block to connect (Always "_device"_)
#   - srcport = Clock domain on the source block to connect
#   - dstblk  = Destination block to connect
#   - dstport = Clock domain on the destination block to connect
clk_domains:
  - { srcblk: _device_, srcport: radio, dstblk: radio0,   dstport: radio }
  - { srcblk: _device_, srcport: radio, dstblk: radio1,   dstport: radio }
  - { srcblk: _device_, srcport: ce,    dstblk: shiftright0, dstport: ce }
  - { srcblk: _device_, srcport: ce,    dstblk: fir0,     dstport:    ce }
  # Unsed by Uplink:
  - { srcblk: _device_, srcport: ce,    dstblk: shiftright1, dstport: ce }
  - { srcblk: _device_, srcport: ce,    dstblk: fir1,     dstport:    ce }
